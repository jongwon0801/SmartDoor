#### 테이블 생성 쿼리 파악

```less
SHOW CREATE TABLE hizib.smartdoor_group;

테이블 생성 시 사용된 SQL 구문 전체를 보여줌

테이블 구조, 키, 인덱스, 제약조건 확인 가능

삭제 실패, 제약조건 문제 진단 시 유용
```


#### ✅ Step 1. smartdoor_message 외래키 확인 (이 테이블이 참조당하고 있는가?)

```less
SELECT *
FROM information_schema.KEY_COLUMN_USAGE
WHERE REFERENCED_TABLE_NAME = 'smartdoor_message'
AND REFERENCED_TABLE_SCHEMA = 'hizib';
```

→ 결과가 없으면 다른 테이블에서 참조하고 있는 게 없다는 뜻 → TRUNCATE 가능


#### ✅ Step 2. 트리거 확인 (삭제 시 자동 삽입하는 로직 있는가?)

```less
SHOW TRIGGERS FROM hizib LIKE 'smartdoor_message';
```

→ AFTER DELETE 같은 게 보이면 → DELETE 후에 다시 살아나는 이유일 수 있음


#### ✅ Step 3. 세션 자동 커밋 상태 확인

```less
SELECT @@autocommit;
```

→ 0이면, DELETE 후 COMMIT; 안 하면 데이터는 실제로 지워지지 않음


| 원인                       | 설명                              |
| ------------------------ | ------------------------------- |
| 외래키 제약은 TRUNCATE에는 느슨    | 자식이면 `TRUNCATE` 허용되기도 함         |
| `DELETE`는 트리거 작동, 외래키 체크 | 내부에서 삭제 실패/롤백/복원될 수 있음          |
| `TRUNCATE`는 트리거 작동 안 함   | 그래서 복구되지 않고 바로 삭제               |
| 트랜잭션 처리 차이               | `DELETE`는 COMMIT 안 하면 rollback됨 |


#### smartdoor_user를 참조하는 외래키 전체 확인 쿼리
```less
SELECT
    TABLE_NAME,
    COLUMN_NAME,
    CONSTRAINT_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM
    information_schema.KEY_COLUMN_USAGE
WHERE
    REFERENCED_TABLE_NAME IS NOT NULL
    AND REFERENCED_TABLE_NAME = 'smartdoor_user'
    AND REFERENCED_TABLE_SCHEMA = 'hizib';
```

####  smartdoor_user 외래키 확인
```less
SELECT *
FROM information_schema.KEY_COLUMN_USAGE
WHERE REFERENCED_TABLE_NAME = 'smartdoor_user'
AND REFERENCED_TABLE_SCHEMA = 'hizib';
```









