#### 1. SD 카드 디스크 번호 확인

```less
diskutil list

/dev/disk4 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *256.1 GB   disk4
   1:                        EFI EFI                     209.7 MB   disk4s1
   2:       Microsoft Basic Data 무제                  255.8 GB   disk4s2

/dev/disk5 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *32.0 GB    disk5
   1:             Windows_FAT_32 boot                    43.8 MB    disk5s1
   2:                      Linux                         15.9 GB    disk5s2
                    (free space)                         16.1 GB    -
```

#### 2. 외장 하드의 마운트 경로 확인

```less
ls /Volumes

'Macintosh HD'   boot   외장

```

#### 3-1. 디스크 전체 복사 (부팅됨)
```less
# 막대기 삼성 usb드라이브 외장 에 sd 카드 이미지 만들기
sudo dd if=/dev/rdisk5 of="/Volumes/외장/정은치엘로B.img" bs=1m status=progress

# 소형 usb드라이브 Untitled 에 sd 카드 이미지 만들기
sudo dd if=/dev/rdisk5 of="/Volumes/Untitled/Smartdoor161_Add_IOT_20250501.img" bs=1m status=progress

# Untitled 드라이브의 img 이미지파일을 외장 드라이브에 복사
sudo cp /Volumes/Untitled/Smartdoor161_Add_IOT_20250501.img /Volumes/외장/
```

대상: rdisk5 → 전체 SD 카드 (전체 32GB, 파티션 + 빈 공간 포함)

결과: 약 28~32GB 크기의 .img 파일 생김

포함 내용:

부트 섹터 (MBR 등)

모든 파티션 (boot, Linux)

비어 있는 공간 (free space)까지 전부 포함

🧱 이 이미지는 디스크 전체를 그대로 복원할 수 있음 (파티션 구조까지 그대로)



#### 3-2. 파티션 하나만 복사 (용량은 줄어들지만 부팅안됨)

```less
sudo dd if=/dev/rdisk5s2 of=/Volumes/외장하드/test.img bs=1m status=progress
```

```less
주의!! : 정은치엘로B.img 이미지 파일이름 한글로하면 0바이트로 복사됨

파일이름은 영어로 해야함 !!
```
대상: rdisk5s2 → Linux 파티션 (15.9GB)

결과: 딱 15.9GB 정도의 .img 파일

포함 내용:

해당 파티션의 데이터만 복사

부트 섹터나 다른 파티션은 포함 안 됨

📂 이 이미지는 해당 파티션만 복원 가능
→ 복원하려면 먼저 똑같은 구조의 파티션을 수동으로 만들어줘야 함

---

안될 경우

❗️1. exFAT + 한글 파일 이름 문제
exFAT 드라이브(무제)에 한글 파일명으로 쓸 때 간혹 macOS에서 문제 생길 가능성 있음

특히 dd 같은 저수준 명령어는 이런 인코딩 문제에 민감함

❗️2. 쓰기 캐시 문제 or write error
dd 가 실제로 쓰기 전에 실패했는데, 그 메시지가 안 보였을 수 있음

또는 외장하드가 read-only 상태로 마운트되어 있었을 가능성도 있음

---

#### 3-3. 부팅가능 img -> 용량줄이기

1. dd로 rdisk5 전체 이미지 생성 (부트로더 포함)

2. 리눅스 환경에서 pishrink.sh 사용

3. 부트 가능 + 용량 작게 압축된 .img 파일 만들 수 있음

```less
디스크 유틸리티로 만든 dmg 이미지는 pishrink 사용 불가
pishrink.sh는 라즈베리파이용 .img 파일 전용 도구
.dmg는 macOS 디스크 이미지 포맷이라서 구조가 다름
```

```less
sudo dd if=/dev/rdisk5 of=/Volumes/외장하드/정은치엘로B.img bs=1m status=progress
```





